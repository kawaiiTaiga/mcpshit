# Wake Word + Whisper GPU ì„œë²„ ì‹œìŠ¤í…œ

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í˜¸ìŠ¤íŠ¸ (Windows/Linux)              â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ wakeword_client.py          â”‚   â”‚
â”‚  â”‚ - Wake Word ê°ì§€ (CPU)      â”‚   â”‚
â”‚  â”‚ - ë§ˆì´í¬ ë…¹ìŒ               â”‚   â”‚
â”‚  â”‚ - API í˜¸ì¶œ                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚ HTTP Request          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ localhost:8000
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker Container (GPU)             â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ whisper_server.py           â”‚   â”‚
â”‚  â”‚ - Faster-Whisper (GPU)      â”‚   â”‚
â”‚  â”‚ - FastAPI ì„œë²„              â”‚   â”‚
â”‚  â”‚ - ìŒì„±â†’í…ìŠ¤íŠ¸ ë³€í™˜          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. Docker GPU ì„œë²„ ì‹¤í–‰

```bash
# Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ì‹¤í–‰
docker-compose up -d --build

# ë¡œê·¸ í™•ì¸
docker-compose logs -f

# ì„œë²„ ìƒíƒœ í™•ì¸
curl http://localhost:8000/health
```

### 2. í˜¸ìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ ì‹¤í–‰

**í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜:**
```bash
pip install openwakeword pyaudio numpy requests
```

**í´ë¼ì´ì–¸íŠ¸ ì‹¤í–‰:**
```bash
python wakeword_client.py
```

## âš™ï¸ ì„¤ì •

### Docker ì„œë²„ (whisper_server.py)
```python
whisper_model = WhisperModel(
    "medium",        # ëª¨ë¸ í¬ê¸°: tiny, base, small, medium, large
    device="cuda",   # GPU ì‚¬ìš©
    compute_type="float16"
)
```

### í˜¸ìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ (wakeword_client.py)
```python
client = WakeWordClient(
    wakeword_model_path="ê²½ë¡œ/ruby_chan.onnx",  # Wake Word ëª¨ë¸ ê²½ë¡œ
    whisper_server_url="http://localhost:8000",  # Docker ì„œë²„ ì£¼ì†Œ
    wakeword_threshold=0.5,                      # Wake Word ë¯¼ê°ë„
    max_recording_duration=10.0,                 # ìµœëŒ€ ë…¹ìŒ ì‹œê°„(ì´ˆ)
    silence_duration=1.5,                        # ë¬´ìŒ ê°ì§€ ì‹œê°„(ì´ˆ)
    silence_threshold=500,                       # ë¬´ìŒ ì„ê³„ê°’
    cooldown_time=3.0                            # ì¿¨ë‹¤ìš´ ì‹œê°„(ì´ˆ)
)
```

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### GET `/`
ì„œë²„ ìƒíƒœ í™•ì¸
```bash
curl http://localhost:8000/
```

### GET `/health`
í—¬ìŠ¤ì²´í¬
```bash
curl http://localhost:8000/health
```

### POST `/transcribe`
ìŒì„± íŒŒì¼ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
```bash
curl -X POST http://localhost:8000/transcribe \
  -F "audio=@audio.raw"
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "text": "ì•ˆë…•í•˜ì„¸ìš” ë£¨ë¹„ì…ë‹ˆë‹¤",
  "language": "ko",
  "segments": [
    {
      "start": 0.0,
      "end": 2.5,
      "text": "ì•ˆë…•í•˜ì„¸ìš” ë£¨ë¹„ì…ë‹ˆë‹¤"
    }
  ]
}
```

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Docker GPU ë¯¸ì‘ë™
```bash
# NVIDIA Docker ëŸ°íƒ€ì„ í™•ì¸
docker run --rm --gpus all nvidia/cuda:12.1.0-base-ubuntu22.04 nvidia-smi

# nvidia-docker2 ì„¤ì¹˜ (Ubuntu)
sudo apt-get install -y nvidia-docker2
sudo systemctl restart docker
```

### í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ì‹¤íŒ¨
```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
curl http://localhost:8000/health

# í¬íŠ¸ê°€ ì—´ë ¤ìˆëŠ”ì§€ í™•ì¸
netstat -an | grep 8000

# ë°©í™”ë²½ í™•ì¸ (Windows)
# Windows Defender ë°©í™”ë²½ì—ì„œ 8000ë²ˆ í¬íŠ¸ í—ˆìš©
```

### PyAudio ì„¤ì¹˜ ì˜¤ë¥˜ (Windows)
```bash
# Visual Studio Build Tools í•„ìš”
# ë˜ëŠ” ë¯¸ë¦¬ ì»´íŒŒì¼ëœ wheel ì‚¬ìš©
pip install pipwin
pipwin install pyaudio
```

## ğŸ’¡ ì¥ì 

1. **ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì„±**
   - Wake Word ê°ì§€: CPU (ì €ì „ë ¥, í•­ìƒ ì‹¤í–‰)
   - Whisper STT: GPU (ê³ ì„±ëŠ¥, í•„ìš”í•  ë•Œë§Œ)

2. **ìœ ì—°ì„±**
   - ì„œë²„ëŠ” Dockerë¡œ ê²©ë¦¬
   - í˜¸ìŠ¤íŠ¸ì—ì„œ ë§ˆì´í¬ ì§ì ‘ ì ‘ê·¼
   - ì–¸ì–´/ëª¨ë¸ ë³€ê²½ ìš©ì´

3. **í™•ì¥ì„±**
   - ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•˜ë‚˜ì˜ GPU ì„œë²„ ê³µìœ  ê°€ëŠ¥
   - ë¡œë“œ ë°¸ëŸ°ì‹± ê°€ëŠ¥

4. **ê°œë°œ í¸ì˜ì„±**
   - í´ë¼ì´ì–¸íŠ¸ë§Œ ìˆ˜ì •í•˜ë©´ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
   - ì„œë²„ëŠ” ì•ˆì •ì ìœ¼ë¡œ ê³„ì† ì‹¤í–‰

## ğŸ“Š ì„±ëŠ¥

- **Wake Word ê°ì§€ ì§€ì—°**: ~100ms (CPU)
- **Whisper ë³€í™˜ ì‹œê°„**: ~1-3ì´ˆ (GPU, medium ëª¨ë¸)
- **ì´ ì‘ë‹µ ì‹œê°„**: ~2-4ì´ˆ

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

í˜„ì¬ëŠ” ë¡œì»¬í˜¸ìŠ¤íŠ¸ë§Œ ì‚¬ìš©í•˜ì§€ë§Œ, ì™¸ë¶€ ë…¸ì¶œ ì‹œ:
- API í‚¤ ì¸ì¦ ì¶”ê°€
- HTTPS ì‚¬ìš©
- Rate limiting ì„¤ì •
- ì˜¤ë””ì˜¤ ë°ì´í„° ì•”í˜¸í™”

## ğŸ“ ë¼ì´ì„ ìŠ¤

- openwakeword: Apache 2.0
- faster-whisper: MIT
- FastAPI: MIT
